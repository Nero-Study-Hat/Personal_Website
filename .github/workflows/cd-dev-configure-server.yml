name: CD-Dev Configure server with Ansible

on:
  workflow_dispatch:
    inputs:
      action:
        description: 'Choose action: deploy or destroy'
        required: true
        default: 'deploy'
        type: choice
        options:
          - deploy
          - destroy
      environment_name:
        description: 'Environment to deploy/destroy'
        required: false 
        default: 'Development'

jobs:
  build-pipeline:
    runs-on: ubuntu-latest

    steps:
      # Checkout the repository
      - name: Checkout current repository
        uses: actions/checkout@v4

      # Tailscale Handling
      - name: Tailscale authkey authenticate
        uses: tailscale/github-action@v4
        with:
          authkey: ${{ secrets.TAILSCALE_AUTHKEY }}

      - name: Tailscale ping to verify connectivity
        uses: tailscale/github-action@v4
        with:
          ping: debian12-webvm